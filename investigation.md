# Paths through the Labyrinth of Florentius

Florentius was a tenth-century monk in northern Spain, a scribe and a good one.

In one of the books he enscribed, he made a famous "labyrinth" page, with a matrix of letters (and other beautiful decorations).

![Forensis's Labyrinth](https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/Moralia_in_Job_945_-_Laberinto_conmemorativo_-_Biblioteca_Nacional_Cod80.JPG/424px-Moralia_in_Job_945_-_Laberinto_conmemorativo_-_Biblioteca_Nacional_Cod80.JPG)

Let me repeat the letters here:

<table>
<tr><td>T</td><td>N</td><td>E</td><td>R</td><td>O</td><td>L</td><td>F</td><td>L</td><td>O</td><td>R</td><td>E</td><td>N</td><td>T</td></tr>
<tr><td>I</td><td>T</td><td>N</td><td>E</td><td>R</td><td>O</td><td>L</td><td>O</td><td>R</td><td>E</td><td>N</td><td>T</td><td>I</td></tr>
<tr><td>U</td><td>I</td><td>T</td><td>N</td><td>E</td><td>R</td><td>O</td><td>R</td><td>E</td><td>N</td><td>T</td><td>I</td><td>U</td></tr>
<tr><td>M</td><td>U</td><td>I</td><td>T</td><td>N</td><td>E</td><td>R</td><td>E</td><td>N</td><td>T</td><td>I</td><td>U</td><td>M</td></tr>
<tr><td>I</td><td>M</td><td>U</td><td>I</td><td>T</td><td>N</td><td>E</td><td>N</td><td>T</td><td>I</td><td>U</td><td>M</td><td>I</td></tr>
<tr><td>N</td><td>I</td><td>M</td><td>U</td><td>I</td><td>T</td><td>N</td><td>T</td><td>I</td><td>U</td><td>M</td><td>I</td><td>N</td></tr>
<tr><td>D</td><td>N</td><td>I</td><td>M</td><td>U</td><td>I</td><td>T</td><td>I</td><td>U</td><td>M</td><td>I</td><td>N</td><td>D</td></tr>
<tr><td>I</td><td>D</td><td>N</td><td>I</td><td>M</td><td>U</td><td>I</td><td>U</td><td>M</td><td>I</td><td>N</td><td>D</td><td>I</td></tr>
<tr><td>G</td><td>I</td><td>D</td><td>N</td><td>I</td><td>M</td><td>U</td><td>M</td><td>I</td><td>N</td><td>D</td><td>I</td><td>G</td></tr>
<tr><td>N</td><td>G</td><td>I</td><td>D</td><td>N</td><td>I</td><td>M</td><td>I</td><td>N</td><td>D</td><td>I</td><td>G</td><td>N</td></tr>
<tr><td>U</td><td>N</td><td>G</td><td>I</td><td>D</td><td>N</td><td>I</td><td>N</td><td>D</td><td>I</td><td>G</td><td>N</td><td>U</td></tr>
<tr><td>M</td><td>U</td><td>N</td><td>G</td><td>I</td><td>D</td><td>N</td><td>D</td><td>I</td><td>G</td><td>N</td><td>U</td><td>M</td></tr>
<tr><td>M</td><td>M</td><td>U</td><td>N</td><td>G</td><td>I</td><td>D</td><td>I</td><td>G</td><td>N</td><td>U</td><td>M</td><td>M</td></tr>
<tr><td>E</td><td>M</td><td>M</td><td>U</td><td>N</td><td>G</td><td>I</td><td>G</td><td>N</td><td>U</td><td>M</td><td>M</td><td>E</td></tr>
<tr><td>M</td><td>E</td><td>M</td><td>M</td><td>U</td><td>N</td><td>G</td><td>N</td><td>U</td><td>M</td><td>M</td><td>E</td><td>M</td></tr>
<tr><td>O</td><td>M</td><td>E</td><td>M</td><td>M</td><td>U</td><td>N</td><td>U</td><td>M</td><td>M</td><td>E</td><td>M</td><td>O</td></tr>
<tr><td>R</td><td>O</td><td>M</td><td>E</td><td>M</td><td>M</td><td>U</td><td>M</td><td>M</td><td>E</td><td>M</td><td>O</td><td>R</td></tr>
<tr><td>A</td><td>R</td><td>O</td><td>M</td><td>E</td><td>M</td><td>M</td><td>M</td><td>E</td><td>M</td><td>O</td><td>R</td><td>A</td></tr>
<tr><td>R</td><td>A</td><td>R</td><td>O</td><td>M</td><td>E</td><td>M</td><td>E</td><td>M</td><td>O</td><td>R</td><td>A</td><td>R</td></tr>
<tr><td>E</td><td>R</td><td>A</td><td>R</td><td>O</td><td>M</td><td>E</td><td>M</td><td>O</td><td>R</td><td>A</td><td>R</td><td>E</td></tr>
</table>

On inspection, you can see the letter **F** in the middle of the top row, and if you read to the end, and then _down_ the last column, a phrase will jump out at you (well, if you know Latin, and are used to not using spaces): **FLORENTIUMINDIGNUMMEMORARE** Furthermore, if you start from the **F** and go _backwards_ across the top row, and then down the _first_ column, you'll see the phrase there, as well. And, if start from that **F**, go _down_ a bit, then _left_ (or _right_) a bit, over and over then until you hit the edge, you'll see it _again_. "FLORENTIUM INDIGNUM MEMORARE" is enscribed over and over: "Remember unworthy Forensis."

Here are three such examples:

<table>
<tr><th>T</th><th>N</th><th>E</th><th>R</th><th>O</th><th>L</th><th>F</th><th>L</th><th>O</th><th>R</th><th>E</th><th>N</th><th>T</th></tr>
<tr><th>I</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>L</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>I</th></tr>
<tr><th>U</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>O</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>U</th></tr>
<tr><th>M</th><td>·</td><td>·</td><td>·</td><th>N</th><th>E</th><th>R</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>M</th></tr>
<tr><th>I</th><td>·</td><td>·</td><td>·</td><th>T</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>I</th></tr>
<tr><th>N</th><td>·</td><td>·</td><td>·</td><th>I</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>N</th></tr>
<tr><th>D</th><td>·</td><td>·</td><td>·</td><th>U</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>D</th></tr>
<tr><th>I</th><th>D</th><th>N</th><th>I</th><th>M</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>I</th></tr>
<tr><th>G</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>G</th></tr>
<tr><th>N</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>N</th></tr>
<tr><th>U</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>U</th></tr>
<tr><th>M</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>M</th></tr>
<tr><th>M</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>M</th></tr>
<tr><th>E</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>E</th></tr>
<tr><th>M</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>M</th></tr>
<tr><th>O</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>O</th></tr>
<tr><th>R</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>R</th></tr>
<tr><th>A</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>A</th></tr>
<tr><th>R</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>R</th></tr>
<tr><th>E</th><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><td>·</td><th>E</th></tr>
</table>

So, a question to ask: **How many ways are there to trace FLORENTIUM INDIGNUM MEMORARE in this labyrinth?** Calculemus!

First, some definitions: A _cell_ contains a x,y coordinate and a letter. A _path_ is list of cells. A _labyrinth_ is an array of cells, with cell coordinates starting at 0,0 in the top left (as is common in computer science). The letter **F** above is in the cell at 6,0, and the **E** at the bottom right is at (12, 19). A _proper prefix_ of a string is a non-empty string that starts the string; for example, `ab` is a proper prefix of `abbot`, but `abc` is not.

We can do a [breadth-first search](https://en.wikipedia.org/wiki/Breadth-first_search) through the array to find just those paths whose letters, in order, spell out "FLORENTIUMINDIGNUMMEMORARE". We do this by creating a queue of paths, starting with a path with just one cell: (0, 6, F). We then enter a loop:

```
while queue is not empty:
    remove the first path in the queue
    if the path spells out the phrase, add it to the list of found paths
    otherwise,
      collect all the neighbors of the last cell in the path
      for each neighbor:
          create a new path with the cell appended to the current path
          if this path spells out a proper prefix of the phrase, add it to the queue
```

This algorithm will eventually terminate because the number of cells is limited. _Note_: it would not terminate if a cell is added to a path that was just visited -- in other words, if a loop is created -- but that doesn't happen in the current case.

Running this algorithm over the current labyrinth, we get the answer to our question: **354,200**, or 2^3×5^2×7×11×23.

Make your own [Labyrinth](https://willf.github.io/florentius/)!

See it [live](https://observablehq.com/@wiseman/florensis-labyrinth)! (thanks to John Wiseman).

CUM ❤️ GULIELMO FECIT ET SALVA EUM, DEUS
